@prefix : <http://diggi.io/ontology/dialog#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .

# Ontology Metadata
<http://diggi.io/ontology/dialog> a owl:Ontology ;
    dcterms:title "Dialog System Core Ontology" ;
    dcterms:description "Core ontology for multimodal dialog management with confidence scoring" ;
    dcterms:created "2025-01-15"^^xsd:date ;
    owl:versionInfo "1.0" .

# Core Classes
:Dialog a owl:Class ;
    rdfs:label "Dialog" ;
    rdfs:comment "A complete dialog session with a user" .

:DialogNode a owl:Class ;
    rdfs:label "Dialog Node" ;
    rdfs:comment "A single node in the dialog flow" .

:Question a owl:Class ;
    rdfs:subClassOf :DialogNode ;
    rdfs:label "Question" ;
    rdfs:comment "A question node that requires user input" .

:Answer a owl:Class ;
    rdfs:label "Answer" ;
    rdfs:comment "User's response to a question" .

:ConditionalBranch a owl:Class ;
    rdfs:subClassOf :DialogNode ;
    rdfs:label "Conditional Branch" ;
    rdfs:comment "A branching point based on conditions" .

:SubQuestion a owl:Class ;
    rdfs:subClassOf :Question ;
    rdfs:label "Sub Question" ;
    rdfs:comment "A nested question that appears conditionally based on parent answer" .

:Section a owl:Class ;
    rdfs:subClassOf :DialogNode ;
    rdfs:label "Section" ;
    rdfs:comment "A grouping of related questions in the dialog" .

# Properties
:hasNode a owl:ObjectProperty ;
    rdfs:label "has node" ;
    rdfs:domain :Dialog ;
    rdfs:range :DialogNode .

:hasQuestion a owl:ObjectProperty ;
    rdfs:label "has question" ;
    rdfs:domain :Dialog ;
    rdfs:range :Question .

:nextNode a owl:ObjectProperty ;
    rdfs:label "next node" ;
    rdfs:domain :DialogNode ;
    rdfs:range :DialogNode .

:branchCondition a owl:DatatypeProperty ;
    rdfs:label "branch condition" ;
    rdfs:domain :ConditionalBranch ;
    rdfs:range xsd:string .

# Conditional Logic Properties
:hasSubQuestion a owl:ObjectProperty ;
    rdfs:label "has sub question" ;
    rdfs:domain :Question ;
    rdfs:range :SubQuestion ;
    rdfs:comment "Links a question to its conditional sub-questions" .

:parentQuestion a owl:ObjectProperty ;
    rdfs:label "parent question" ;
    rdfs:domain :SubQuestion ;
    rdfs:range :Question ;
    rdfs:comment "The parent question this sub-question belongs to" .

:showIf a owl:DatatypeProperty ;
    rdfs:label "show if" ;
    rdfs:domain :SubQuestion ;
    rdfs:range xsd:string ;
    rdfs:comment "Condition for showing this sub-question (e.g., 'answer == yes')" .

:conditionOperator a owl:DatatypeProperty ;
    rdfs:label "condition operator" ;
    rdfs:domain :SubQuestion ;
    rdfs:range xsd:string ;
    rdfs:comment "Operator for condition: equals, not_equals, contains, greater_than, less_than, in, not_in" .

:conditionValue a owl:DatatypeProperty ;
    rdfs:label "condition value" ;
    rdfs:domain :SubQuestion ;
    rdfs:range xsd:string ;
    rdfs:comment "Value to compare against for the condition" .

:conditionField a owl:DatatypeProperty ;
    rdfs:label "condition field" ;
    rdfs:domain :SubQuestion ;
    rdfs:range xsd:string ;
    rdfs:comment "Which field/answer to check (defaults to parent question)" .

:sectionTitle a owl:DatatypeProperty ;
    rdfs:label "section title" ;
    rdfs:domain :Section ;
    rdfs:range xsd:string ;
    rdfs:comment "The display title of the section" .

:sectionDescription a owl:DatatypeProperty ;
    rdfs:label "section description" ;
    rdfs:domain :Section ;
    rdfs:range xsd:string ;
    rdfs:comment "Description of what the section collects" .

:sectionAlias a owl:DatatypeProperty ;
    rdfs:label "section alias" ;
    rdfs:domain :Section ;
    rdfs:range xsd:string ;
    rdfs:comment "Alternative names for the section for voice recognition and natural language understanding" .

:sectionPhonetic a owl:DatatypeProperty ;
    rdfs:label "section phonetic" ;
    rdfs:domain :Section ;
    rdfs:range xsd:string ;
    rdfs:comment "Phonetic spellings of section name for ASR" .

:sectionIcon a owl:DatatypeProperty ;
    rdfs:label "section icon" ;
    rdfs:domain :Section ;
    rdfs:range xsd:string ;
    rdfs:comment "Icon/emoji representing the section" .

:inSection a owl:ObjectProperty ;
    rdfs:label "in section" ;
    rdfs:domain :Question ;
    rdfs:range :Section ;
    rdfs:comment "The section this question belongs to" .

:questionText a owl:DatatypeProperty ;
    rdfs:label "question text" ;
    rdfs:domain :Question ;
    rdfs:range xsd:string .

:questionId a owl:DatatypeProperty ;
    rdfs:label "question ID" ;
    rdfs:domain :Question ;
    rdfs:range xsd:string .

:slotName a owl:DatatypeProperty ;
    rdfs:label "slot name" ;
    rdfs:domain :Question ;
    rdfs:range xsd:string ;
    rdfs:comment "The slot this question fills in the data model" .

:required a owl:DatatypeProperty ;
    rdfs:label "required" ;
    rdfs:domain :Question ;
    rdfs:range xsd:boolean .

:spellingRequired a owl:DatatypeProperty ;
    rdfs:label "spelling required" ;
    rdfs:domain :Question ;
    rdfs:range xsd:boolean ;
    rdfs:comment "Indicates if this field requires precise spelling using phonetic alphabet" .

:hasInputMode a owl:ObjectProperty ;
    rdfs:label "has input mode" ;
    rdfs:domain :Question ;
    rdfs:comment "Links to SKOS InputMode configuration for this question" .

:order a owl:DatatypeProperty ;
    rdfs:label "order" ;
    rdfs:domain :DialogNode ;
    rdfs:range xsd:integer ;
    rdfs:comment "The sequence order of this node" .

# TTL Configuration for Lifecycle Management
:TTLConfiguration a owl:Class ;
    rdfs:label "TTL Configuration" ;
    rdfs:comment "Time-to-live configuration for dialog lifecycle" .

:sessionTTL a owl:DatatypeProperty ;
    rdfs:label "session TTL" ;
    rdfs:domain :TTLConfiguration ;
    rdfs:range xsd:duration ;
    rdfs:comment "Time-to-live for dialog sessions" .

:answerTTL a owl:DatatypeProperty ;
    rdfs:label "answer TTL" ;
    rdfs:domain :TTLConfiguration ;
    rdfs:range xsd:duration ;
    rdfs:comment "Time-to-live for cached answers" .

:recordingTTL a owl:DatatypeProperty ;
    rdfs:label "recording TTL" ;
    rdfs:domain :TTLConfiguration ;
    rdfs:range xsd:duration ;
    rdfs:comment "Time-to-live for audio recordings" .

# Default TTL Configuration Instance
:DefaultTTL a :TTLConfiguration ;
    :sessionTTL "PT30M"^^xsd:duration ;  # 30 minutes
    :answerTTL "PT10M"^^xsd:duration ;   # 10 minutes
    :recordingTTL "P7D"^^xsd:duration .  # 7 days

# Example Dialog Instance
:InsuranceQuoteDialog a :Dialog ;
    rdfs:label "Car Insurance Quote Dialog" ;
    dcterms:description "Comprehensive dialog for collecting car insurance quote information" ;
    :hasNode :WelcomeNode, :DriversSection, :VehicleSection, :PolicySection, :ClaimsSection, :PaymentSection, :ExtrasSection, :MarketingSection, :SummaryNode ;
    :hasQuestion :FirstNameQuestion, :LastNameQuestion, :DOBQuestion, :EmailQuestion, :PhoneQuestion, :AddressQuestion, :PostcodeQuestion, :LicenceTypeQuestion, :LicenceNumberQuestion, :YearsHeldQuestion,
                 :VehicleRegQuestion, :VehicleMakeQuestion, :CarModelQuestion, :CarYearQuestion, :MileageQuestion, :VehicleValueQuestion, :OvernightLocationQuestion, :HasModificationsQuestion,
                 :CoverTypeQuestion, :StartDateQuestion, :VoluntaryExcessQuestion, :NCDYearsQuestion, :ProtectNCDQuestion,
                 :HasClaimsQuestion, :HasConvictionsQuestion,
                 :PaymentFrequencyQuestion, :PaymentMethodQuestion,
                 :BreakdownCoverQuestion, :LegalExpensesQuestion, :CourtesyCarQuestion,
                 :EmailMarketingQuestion, :SMSMarketingQuestion, :PostMarketingQuestion .

:WelcomeNode a :DialogNode ;
    rdfs:label "Welcome" ;
    :order 1 ;
    :nextNode :DriversSection .

# Section 1: Drivers (drivers) - ðŸ‘¤
:DriversSection a :Section ;
    rdfs:label "Drivers" ;
    :sectionTitle "ðŸ‘¤ Driver Information" ;
    :sectionDescription "Driver information and details" ;
    :sectionAlias "Driver Info", "Driver Details", "About the Driver", "Personal Information", "Who's Driving" ;
    :sectionPhonetic "Driver Information", "Dryver Info" ;
    :sectionIcon "ðŸ‘¤" ;
    :order 2 ;
    :nextNode :VehicleSection .

# Section 2: Vehicle (vehicle) - ðŸš—
:VehicleSection a :Section ;
    rdfs:label "Vehicle" ;
    :sectionTitle "ðŸš— Vehicle Details" ;
    :sectionDescription "Vehicle details and specifications" ;
    :sectionAlias "Car Details", "Vehicle Info", "About the Car", "Car Information", "My Vehicle" ;
    :sectionPhonetic "Vee Hickle Details", "Car Details" ;
    :sectionIcon "ðŸš—" ;
    :order 3 ;
    :nextNode :PolicySection .

# Section 3: Policy (policy) - ðŸ“„
:PolicySection a :Section ;
    rdfs:label "Policy" ;
    :sectionTitle "ðŸ“„ Policy Coverage" ;
    :sectionDescription "Policy coverage details" ;
    :order 4 ;
    :nextNode :ClaimsSection .

# Section 4: Claims (claims) - ðŸ“‹
:ClaimsSection a :Section ;
    rdfs:label "Claims" ;
    :sectionTitle "ðŸ“‹ Claims & Convictions" ;
    :sectionDescription "Claims and conviction history" ;
    :order 5 ;
    :nextNode :PaymentSection .

# Section 5: Payment (payment) - ðŸ’³
:PaymentSection a :Section ;
    rdfs:label "Payment" ;
    :sectionTitle "ðŸ’³ Payment Preferences" ;
    :sectionDescription "Payment preferences" ;
    :order 6 ;
    :nextNode :ExtrasSection .

# Section 6: Extras (extras) - âž•
:ExtrasSection a :Section ;
    rdfs:label "Extras" ;
    :sectionTitle "âž• Optional Extras" ;
    :sectionDescription "Optional extras and add-ons" ;
    :order 7 ;
    :nextNode :MarketingSection .

# Section 7: Marketing (marketing) - ðŸ“§
:MarketingSection a :Section ;
    rdfs:label "Marketing" ;
    :sectionTitle "ðŸ“§ Marketing Preferences" ;
    :sectionDescription "Marketing preferences" ;
    :order 8 ;
    :nextNode :SummaryNode .

:SummaryNode a :DialogNode ;
    rdfs:label "Summary" ;
    :order 9 .

# Example: Conditional Logic - Claims Sub-Questions
# Sub-questions for :HasClaimsQuestion (defined in dialog-sections.ttl with questionId "q_has_claims")

# Sub-Question 1: Claim Type (appears if q_has_claims == "YES")
:ClaimTypeSubQuestion a :SubQuestion ;
    rdfs:label "Claim Type" ;
    :questionId "claim_type" ;
    :questionText "What type of claim was it?" ;
    :slotName "claim_type" ;
    :inputType "select" ;
    :required true ;
    :parentQuestion :HasClaimsQuestion ;
    :conditionOperator "equals" ;
    :conditionValue "YES" ;
    :conditionField "q_has_claims" ;
    :showIf "q_has_claims == YES" ;
    :order 2 ;
    :hasOption :ClaimTypeAccident, :ClaimTypeTheft, :ClaimTypeVandalism, :ClaimTypeWindscreen, :ClaimTypeOther .

:ClaimTypeAccident a :SelectOption ;
    rdfs:label "Accident" ;
    :optionValue "accident" ;
    :optionLabel "Accident" ;
    :optionAlias "Collision", "Crash", "Accident Damage" ;
    :forQuestion :ClaimTypeSubQuestion .

:ClaimTypeTheft a :SelectOption ;
    rdfs:label "Theft" ;
    :optionValue "theft" ;
    :optionLabel "Theft" ;
    :optionAlias "Stolen", "Theft of Vehicle", "Car Theft" ;
    :forQuestion :ClaimTypeSubQuestion .

:ClaimTypeVandalism a :SelectOption ;
    rdfs:label "Vandalism" ;
    :optionValue "vandalism" ;
    :optionLabel "Vandalism" ;
    :optionAlias "Damage", "Criminal Damage", "Malicious Damage" ;
    :forQuestion :ClaimTypeSubQuestion .

:ClaimTypeWindscreen a :SelectOption ;
    rdfs:label "Windscreen" ;
    :optionValue "windscreen" ;
    :optionLabel "Windscreen" ;
    :optionAlias "Glass", "Windshield", "Window", "Windscreen Damage" ;
    :forQuestion :ClaimTypeSubQuestion .

:ClaimTypeOther a :SelectOption ;
    rdfs:label "Other" ;
    :optionValue "other" ;
    :optionLabel "Other" ;
    :forQuestion :ClaimTypeSubQuestion .

# Sub-Question 2: Claim Date (appears if q_has_claims == "YES")
:ClaimDateSubQuestion a :SubQuestion ;
    rdfs:label "Claim Date" ;
    :questionId "claim_date" ;
    :questionText "When did the claim occur?" ;
    :slotName "claim_date" ;
    :inputType "date" ;
    :required true ;
    :parentQuestion :HasClaimsQuestion ;
    :conditionOperator "equals" ;
    :conditionValue "YES" ;
    :conditionField "q_has_claims" ;
    :showIf "q_has_claims == YES" ;
    :order 3 .

# Sub-Question 3: Claim Amount (appears if q_has_claims == "YES")
:ClaimAmountSubQuestion a :SubQuestion ;
    rdfs:label "Claim Amount" ;
    :questionId "claim_amount" ;
    :questionText "What was the approximate claim amount?" ;
    :slotName "claim_amount" ;
    :inputType "number" ;
    :required true ;
    :parentQuestion :HasClaimsQuestion ;
    :conditionOperator "equals" ;
    :conditionValue "YES" ;
    :conditionField "q_has_claims" ;
    :showIf "q_has_claims == YES" ;
    :order 4 ;
    :validationMin "0" ;
    :validationMax "100000" .

# Sub-Question 4: Claim Description (appears if q_has_claims == "YES")
:ClaimDescriptionSubQuestion a :SubQuestion ;
    rdfs:label "Claim Description" ;
    :questionId "claim_description" ;
    :questionText "Please provide a brief description of the claim" ;
    :slotName "claim_description" ;
    :inputType "textarea" ;
    :required false ;
    :parentQuestion :HasClaimsQuestion ;
    :conditionOperator "equals" ;
    :conditionValue "YES" ;
    :conditionField "q_has_claims" ;
    :showIf "q_has_claims == YES" ;
    :order 5 ;
    :validationMaxLength "500" .
